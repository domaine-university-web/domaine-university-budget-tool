<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Money Breakdown Tool (Pro)</title>

  <!-- Helps it feel more like a home-screen app -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />

  <style>
    :root { --pad: 16px; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      margin: 0;
      padding: calc(env(safe-area-inset-top) + var(--pad)) var(--pad) calc(env(safe-area-inset-bottom) + var(--pad));
      background: #fff; color: #111;
      max-width: 780px;
    }
    h1 { font-size: 22px; margin: 0 0 10px; }
    .card { border: 1px solid #e5e5e5; border-radius: 14px; padding: 14px; }
    label { display:block; margin: 6px 0 8px; font-weight: 600; }
    input {
      width: 100%; padding: 14px 12px; font-size: 18px;
      border-radius: 12px; border: 1px solid #cfcfcf;
      box-sizing: border-box;
    }
    .row { display:flex; gap: 10px; margin-top: 12px; flex-wrap: wrap; }
    button {
      flex: 1;
      padding: 14px 12px;
      font-size: 17px;
      border-radius: 12px;
      border: 0;
      cursor: pointer;
      min-width: 160px;
    }
    button.primary { background:#111; color:#fff; }
    button.secondary { background:#efefef; color:#111; }
    button.danger { background:#ffe8e8; color:#8a0000; }
    table { width:100%; border-collapse: collapse; margin-top: 12px; }
    th, td { padding: 12px 8px; border-bottom: 1px solid #f0f0f0; text-align:left; font-size: 16px; vertical-align: top; }
    th { font-size: 13px; color:#666; text-transform: uppercase; letter-spacing: .04em; }
    .total { font-weight: 700; }
    .note { margin-top: 10px; color:#666; font-size: 13px; line-height: 1.35; }

    .split-header { display:flex; align-items: baseline; justify-content: space-between; gap: 10px; margin-top: 10px; }
    .split-header h2 { font-size: 16px; margin: 0; }
    .muted { color:#666; font-size: 13px; }
    .split-table input {
      padding: 12px 10px;
      font-size: 16px;
      border-radius: 10px;
    }
    .split-table td input { margin-top: 4px; }
    .pct-input { max-width: 120px; }
    .name-input { width: 100%; }
    .actions { display:flex; gap: 8px; align-items: center; justify-content: flex-end; }
    .sum-badge {
      display:inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      background:#f6f6f6;
      font-size: 13px;
      color:#333;
      white-space: nowrap;
    }
    .sum-badge.bad { background:#fff2cc; color:#6b4f00; }
    .sum-badge.good { background:#eaf7ee; color:#1f6b2e; }
    .tiny { font-size: 12px; color:#666; }
  </style>
</head>
<body>

  <!-- âœ… UPDATED TITLE -->
  <h1>ðŸ’° Money Breakdown Tool (Pro)</h1>

  <div class="card">
    <label for="amount">Enter amount</label>
    <input id="amount" inputmode="decimal" placeholder="e.g., 2500" />

    <div class="split-header">
      <h2>Categories & Percentages</h2>
      <div class="actions">
        <span id="sumBadge" class="sum-badge">Total: 0%</span>
      </div>
    </div>

    <div class="muted">
      Edit names and percentages. Percent can be typed like <b>15</b> (meaning 15%).
    </div>

    <table class="split-table" style="margin-top:10px;">
      <thead>
        <tr>
          <th style="width:55%;">Category</th>
          <th style="width:25%;">Percent</th>
          <th style="width:20%; text-align:right;">Action</th>
        </tr>
      </thead>
      <tbody id="splitTbody"></tbody>
    </table>

    <div class="row">
      <button class="secondary" onclick="addSplit()">+ Add category</button>
      <button class="secondary" onclick="resetSplits()">Reset defaults</button>
      <button class="primary" onclick="calculate()">Calculate</button>
      <button class="secondary" onclick="clearAll()">Clear</button>
    </div>

    <div id="results" style="display:none;">
      <table>
        <thead>
          <tr><th>Category</th><th>%</th><th>Amount</th></tr>
        </thead>
        <tbody id="tbody"></tbody>
        <tfoot>
          <tr class="total">
            <td>Total</td>
            <td>100%</td>
            <td id="totalCell"></td>
          </tr>
        </tfoot>
      </table>

      <div class="row">
        <button class="secondary" onclick="copyText()">Copy breakdown</button>
        <button class="primary" onclick="exportCSV()">Export CSV</button>
      </div>

      <div class="note" id="note"></div>
    </div>

    <div class="tiny" style="margin-top:10px;">
      Saved on this device: amount + categories + percentages.
    </div>
  </div>

<script>
  /* === JavaScript unchanged except pill removed === */

  const DEFAULT_SPLITS = [
    { name: "Household", pct: 50 },
    { name: "Tax", pct: 15 },
    { name: "Charitable Giving", pct: 10 },
    { name: "Giving (Family)", pct: 5 },
    { name: "Investing", pct: 20 },
  ];

  const LS_AMOUNT = "lastAmount";
  const LS_SPLITS = "moneyBreakdownSplitsV2";

  const amountEl = document.getElementById("amount");
  const splitTbody = document.getElementById("splitTbody");
  const sumBadge = document.getElementById("sumBadge");

  let splits = loadSplits();

  const savedAmt = localStorage.getItem(LS_AMOUNT);
  if (savedAmt) amountEl.value = savedAmt;

  renderSplits();

  function clamp(n, min, max) {
    return Math.min(max, Math.max(min, n));
  }

  function parsePct(value) {
    const s = String(value).trim().replace("%", "");
    if (s === "") return NaN;
    const n0 = Number(s);
    if (!isFinite(n0)) return NaN;
    return n0 > 0 && n0 < 1 ? n0 * 100 : n0;
  }

  function totalPct() {
    return splits.reduce((sum, s) => sum + (Number(s.pct) || 0), 0);
  }

  function remainingPct(excludeIndex) {
    return splits.reduce((sum, s, i) => i === excludeIndex ? sum : sum + (Number(s.pct) || 0), 0);
  }

  function roundPct(p) {
    return Math.round(p * 100) / 100;
  }

  function updateSumBadge() {
    const sum = roundPct(totalPct());
    sumBadge.textContent = `Total: ${sum}%`;
    sumBadge.className = "sum-badge " + (Math.abs(sum - 100) < 0.01 ? "good" : "bad");
  }

  function saveSplits() {
    localStorage.setItem(LS_SPLITS, JSON.stringify(splits));
    updateSumBadge();
  }

  function loadSplits() {
    try {
      const raw = localStorage.getItem(LS_SPLITS);
      return raw ? JSON.parse(raw) : structuredClone(DEFAULT_SPLITS);
    } catch {
      return structuredClone(DEFAULT_SPLITS);
    }
  }

  function renderSplits() {
    splitTbody.innerHTML = "";
    splits.forEach((s, idx) => {
      const tr = document.createElement("tr");

      tr.innerHTML = `
        <td><input class="name-input" value="${s.name}"></td>
        <td><input class="pct-input" value="${roundPct(s.pct)}"></td>
        <td style="text-align:right;">
          <button class="danger" onclick="removeSplit(${idx})">Remove</button>
        </td>
      `;

      const nameInput = tr.querySelector(".name-input");
      const pctInput = tr.querySelector(".pct-input");

      nameInput.oninput = () => { splits[idx].name = nameInput.value; saveSplits(); };

      pctInput.oninput = () => {
        const entered = parsePct(pctInput.value);
        if (!isFinite(entered)) return;
        const max = 100 - remainingPct(idx);
        splits[idx].pct = clamp(entered, 0, max);
        saveSplits();
      };

      pctInput.onblur = () => pctInput.value = roundPct(splits[idx].pct);

      splitTbody.appendChild(tr);
    });

    updateSumBadge();
  }

  function addSplit() { splits.push({ name:"", pct:0 }); saveSplits(); renderSplits(); }
  function removeSplit(i) { if (splits.length > 1) { splits.splice(i,1); saveSplits(); renderSplits(); } }
  function resetSplits() { splits = structuredClone(DEFAULT_SPLITS); saveSplits(); renderSplits(); }

  function calculate() {
    const total = Number(amountEl.value.replace(/[$, ]/g,""));
    if (!isFinite(total)) return alert("Enter a valid amount");
    if (Math.abs(totalPct() - 100) > 0.01) return alert("Percentages must total 100%");
    document.getElementById("totalCell").textContent = `$${total.toFixed(2)}`;
    document.getElementById("results").style.display = "block";
  }

  function clearAll() {
    amountEl.value = "";
    localStorage.removeItem(LS_AMOUNT);
    document.getElementById("results").style.display = "none";
  }
</script>
</body>
</html>
